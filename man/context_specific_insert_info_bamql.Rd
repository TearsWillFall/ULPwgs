% Generated by roxygen2: do not edit by hand
% Please edit documentation in R/bamql.R
\name{context_specific_insert_info_bamql}
\alias{context_specific_insert_info_bamql}
\title{Context-Specific Fragment Size Metrics Using BAMQL and Samtools}
\usage{
context_specific_insert_info_bamql(
  bin_picard = build_default_tool_binary_list()$bin_picard,
  bin_samtools = build_default_tool_binary_list()$bin_samtools,
  sif_bamql = build_default_sif_list()$sif_bamql,
  bam = NULL,
  region = NULL,
  query = NULL,
  accepted_id = "accepted",
  rejected_id = "rejected",
  kmers = 4,
  deviations = NULL,
  min_width = NULL,
  width = NULL,
  ...
)
}
\arguments{
\item{bin_picard}{Path to the Picard binary. Default: from build_default_tool_binary_list().}

\item{bin_samtools}{Path to the samtools binary. Default: from build_default_tool_binary_list().}

\item{sif_bamql}{Path to the BAMQL singularity image file. Default: from build_default_sif_list().}

\item{bam}{Path to the input BAM file. (Required)}

\item{region}{Genomic region to extract (e.g., "1:10000-1000000"). (Required)}

\item{query}{BAMQL query string to filter reads. (Required)}

\item{accepted_id}{Identifier for accepted reads output file. Default: "accepted".}

\item{rejected_id}{Identifier for rejected reads output file. Default: "rejected".}

\item{deviations}{Numeric; number of standard deviations for fragment size metrics. Default: NULL.}

\item{min_width}{Numeric; minimum fragment width for metrics. Default: NULL.}

\item{width}{Numeric; fragment width for metrics. Default: NULL.}

\item{...}{Additional arguments passed to environment setup and job execution.}
}
\value{
No direct return value. Output files and metrics are written to disk and tracked in the environment.
}
\description{
This function calculates fragment size metrics for a BAM file in a context-specific manner. It first runs Picard insert size metrics on all reads, then extracts reads from a specified genomic region using samtools, and finally applies BAMQL queries to further subset reads within the region. Fragment size metrics are calculated for each subset using Picard. Output files and metrics are written to disk and tracked in the environment.
}
